      index  ...                                      test_negative
0         0  ...  [3611, 1991, 2909, 2573, 132, 828, 1747, 1011,...
1         1  ...  [1042, 2923, 2769, 1661, 2927, 1708, 3448, 277...
2         2  ...  [1514, 2120, 2570, 1118, 1544, 3027, 3018, 319...
3         3  ...  [122, 1687, 1390, 1700, 2839, 779, 402, 2837, ...
4         4  ...  [737, 1611, 1893, 3328, 1186, 2203, 2327, 2449...
...     ...  ...                                                ...
6035   6035  ...  [1937, 3586, 383, 304, 1810, 1808, 2870, 3327,...
6036   6036  ...  [2981, 1238, 1190, 2977, 3354, 81, 1574, 517, ...
6037   6037  ...  [488, 1493, 3655, 3361, 252, 1331, 3599, 267, ...
6038   6038  ...  [2948, 1441, 3017, 427, 3169, 3327, 43, 2730, ...
6039   6039  ...  [8, 1821, 3071, 1850, 890, 389, 2557, 2645, 18...

[6040 rows x 6 columns]
0 3705 (994169,)
0 6039 (994169,)
0 3705 (597960,)
DataParallel(
  (module): NeuralCF(
    (user_embedding_gmf): Embedding(6040, 8)
    (song_embedding_gmf): Embedding(3706, 8)
    (user_embedding_mlp): Embedding(6040, 32)
    (song_embedding_mlp): Embedding(3706, 32)
    (MLP_layers): Sequential(
      (0): Linear(in_features=64, out_features=32, bias=True)
      (1): ReLU()
      (2): Linear(in_features=32, out_features=16, bias=True)
      (3): ReLU()
      (4): Linear(in_features=16, out_features=8, bias=True)
      (5): ReLU()
    )
    (predict_layer): Linear(in_features=16, out_features=1, bias=True)
  )
)
Epoch 1 starts !
--------------------------------------------------------------------------------
Train Loader 생성 완료
train :  66.88790583610535
        user  item     score  test_item  test_score  rank      ndcg
597962     2   207  0.455830        207    0.612025  10.0  0.289065
597963     3   208 -0.321834        208    0.420229   6.0  0.356207
597965     5   396  0.453462        396    0.611462   3.0  0.500000
597966     6    74  0.200324         74    0.549914   8.0  0.315465
597968     8   514  0.013233        514    0.503308   7.0  0.333333
...      ...   ...       ...        ...         ...   ...       ...
603994  6034   812  0.211665        812    0.552720   6.0  0.356207
603996  6036   294  1.116535        294    0.753346   1.0  1.000000
603997  6037  1528  0.250773       1528    0.562367   3.0  0.500000
603998  6038   420  3.298608        420    0.964381   1.0  1.000000
603999  6039   434  2.964435        434    0.950941   1.0  1.000000

[3343 rows x 7 columns]
[Evluating Epoch 1] HR = 0.5535, NDCG = 0.3126
Patience = 0
Epoch 2 starts !
--------------------------------------------------------------------------------
Train Loader 생성 완료
Traceback (most recent call last):
  File "main.py", line 132, in <module>
    main()
  File "main.py", line 100, in main
    optimizer.step()
  File "/opt/conda/lib/python3.8/site-packages/torch/autograd/grad_mode.py", line 15, in decorate_context
    return func(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/torch/optim/adam.py", line 86, in step
    exp_avg, exp_avg_sq = state['exp_avg'], state['exp_avg_sq']
KeyboardInterrupt
